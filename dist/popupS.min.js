/*! popupS 1.0.0 - MIT | https://github.com/ChiefORZ/popupS.git */
!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.PopupS=b()}(this,function(){"use strict";function a(a,b){if(a)for(var c in a)a.hasOwnProperty(c)&&b(a[c],c,a)}function b(a){a=a||{};for(var b=1;b<arguments.length;b++)if(arguments[b])for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&(a[c]=arguments[b][c]);return a}function c(a){a=a||{};for(var b=1;b<arguments.length;b++){var d=arguments[b];if(d)for(var e in d)d.hasOwnProperty(e)&&("object"==typeof d[e]?c(a[e],d[e]):a[e]=d[e])}return a}function d(a,b,c){"function"==typeof a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}function e(a,b,c){"function"==typeof a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)}function f(a,b,c){if(a&&a.style&&b)if(b instanceof Object)for(var d in b)f(a,d,b[d]);else a.style[b]=c}function g(b){null===b&&(b="div"),"string"==typeof b&&(b={tag:b});var c,d,e=document.createDocumentFragment(),i=b.children,j=n.exec(b.tag||"");return delete b.children,b.tag=j[1]||"div",b.id=b.id||(j[2]||"").substr(1),d=(j[3]||"").split("."),d[0]=b.className||"",b.className=d.join(" "),c=document.createElement(b.tag),h(e,c),delete b.tag,a(b,function(a,d){if("css"===d)f(c,b.css);else if("text"===d)null!==a&&h(c,document.createTextNode(a));else if("html"===d)null!==a&&(c.innerHTML=a);else if(d in c)try{c[d]=a}catch(e){c.setAttribute(d,a)}else/^data-/.test(d)&&c.setAttribute(d,a)}),i&&i.appendChild?h(c,i):i&&(i instanceof Array?a(i,function(a,b){a instanceof Object&&h(c,g(a))}):i instanceof Object&&h(c,g(i))),c}function h(a,b){try{a&&b&&a.appendChild(b)}catch(c){}}function i(a){for(var b,c,d=j(a,"input"),e=0,f=d.length;f>e;e++)if(b=d[e],"submit"===b.type)!c&&(c=b);else if(!/hidden|check|radio/.test(b.type)&&""===b.value){c=b;break}c||(c=j(a,"button")[0]);try{c.focus()}catch(g){}}function j(a,b){return a.getElementsByTagName(b)}function k(a){a&&a.parentNode&&a.parentNode.removeChild(a)}var l={appendLocation:document.body||document.documentElement,addClassName:{base:"",buttonHolder:"",buttonOk:"",buttonCancel:"",closeBtn:"",form:"",overlay:"",popup:""},baseClassName:"popupS",flags:{bodyScroll:!1,buttonReverse:!1,closeByEsc:!0,closeByOverlay:!0,showCloseBtn:!0},labels:{ok:"OK",cancel:"Cancel"},loader:"spinner",zIndex:1e4},m=function(){var a,b,c=!1,d=document.createElement("fakeelement"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"};for(a in e)if(e.hasOwnProperty(a)&&void 0!==d.style[a]){b=e[a],c=!0;break}return{type:b,supported:c}}(),n=/^(\w+)?(#[\w_-]+)?((?:\.[\w_-]+)*)/i;return function(a){var n={},o=!1,p=[],q=new RegExp(/([^\/\\]+)\.(jpg|jpeg|png|gif)$/i);a=c(l,a),a.closeBtn="undefined"!=typeof a.closeBtn&&"string"==typeof a.closeBtn?{tag:"#popupS-close."+a.baseClassName+"-close"+a.addClassName.closeBtn,html:a.closeBtn}:{tag:"span#popupS-close."+a.baseClassName+"-close"+a.addClassName.closeBtn,html:"&times;"};var r=b({},a);r.addClassName=b({},a.addClassName),r.closeBtn=b({},a.closeBtn),r.flags=b({},a.flags),r.labels=b({},a.labels);var s={buttons:{holder:'<nav class="'+a.baseClassName+"-buttons "+a.addClassName.buttonHolder+'">{{buttons}}</nav>',submit:'<button type="submit" class="'+a.baseClassName+"-button-ok "+a.addClassName.buttonOk+'" id="popupS-button-ok">{{ok}}</button>',ok:'<button class="'+a.baseClassName+"-button-ok "+a.addClassName.buttonOk+'" id="popupS-button-ok">{{ok}}</button>',cancel:'<button class="'+a.baseClassName+"-button-cancel "+a.addClassName.buttonCancel+'" id="popupS-button-cancel">{{cancel}}</button>'},input:'<div class="'+a.baseClassName+"-form "+a.addClassName.form+'">{{placeholder}}<input type="text" id="popupS-input" /></div>'};return n={_dialog:function(a){if("string"!=typeof a.mode)throw new Error("mode must be a string");if("undefined"!=typeof a.title&&"string"!=typeof a.title)throw new Error("title must be a string");if("undefined"!=typeof a.placeholder&&"string"!=typeof a.placeholder)throw new Error("placeholder must be a string");if(this._tempOverrideOptions(a),this._init(),a.force===!0)for(;p.length>0;)p.pop();p.push(a),o||this._create()},_tempOverrideOptions:function(d){r=b({},a),r.addClassName=b({},a.addClassName),r.closeBtn=b({},a.closeBtn),r.flags=b({},a.flags),r.labels=b({},a.labels),d.options&&!r?a=c(a,d.options):(a=r,r=void 0)},_init:function(){this.$layerEl&&this.$layerEl.style.opacity&&(this.$layerEl.style.opacity=""),this.$wrapEl||(this.$wrapEl=g({tag:"div."+a.baseClassName+"-base"+a.addClassName.base,css:{top:0,left:0,right:0,bottom:0,position:"fixed",textAlign:"center",overflowX:"auto",overflowY:"auto",outline:0,whiteSpace:"nowrap",zIndex:a.zIndex},children:{css:{height:"100%",display:"inline-block",verticalAlign:"middle"}}}),h(this.$wrapEl,this._getOverlay()),h(this.$wrapEl,this._getLayer()))},_getOverlay:function(){return this.$overlayEl||(this.$overlayEl=g({tag:"#popupS-overlay."+a.baseClassName+"-overlay"+a.addClassName.overlay,css:{top:0,right:0,bottom:0,left:0,position:"fixed",overflowX:"hidden",userSelect:"none",webkitUserSelect:"none",MozUserSelect:"none"}})),this.$overlayEl.setAttribute("unselectable","on"),this.$overlayEl},_getLayer:function(){return this.$layerEl||(this.$layerEl=g({css:{display:"inline-block",position:"relative",textAlign:"left",whiteSpace:"normal",verticalAlign:"middle",transform:"translate3d(0,0,0)"},children:{tag:"."+a.baseClassName+"-layer"+a.addClassName.popup}})),this.$layerEl},_resetLayer:function(){this.$layerEl.childNodes[0].innerHTML=""},_create:function(){var a=this,b=p[0],c=b.mode;"modal-ajax"!=c?this._createPopup(b):this._loadContents(b);var f=function(b){b.stopPropagation(),e(a.$layerEl,m.type,f)};m.supported&&d(a.$layerEl,m.type,f)},_createPopup:function(b){var c,e,f=b.mode,j=b.title,k=b.content,l=b.placeholder?'<label for="popupS-input">'+b.placeholder+"</label>":"",m=b.className?"."+b.className:"",n=k instanceof Object?!0:!1,o="";if(this.callbacks={onOpen:b.onOpen,onSubmit:b.onSubmit,onClose:b.onClose},"string"==typeof k&&(o+=k),"modal"!=f&&"modal-ajax"!=f)switch("prompt"==f&&(o+=s.input,o=o.replace("{{placeholder}}",l)),o+=s.buttons.holder,f){case"prompt":case"confirm":o=o.replace("{{buttons}}",this._appendButtons(s.buttons.cancel,s.buttons.ok)),o=o.replace("{{ok}}",a.labels.ok).replace("{{cancel}}",a.labels.cancel);break;default:o=o.replace("{{buttons}}",s.buttons.ok),o=o.replace("{{ok}}",a.labels.ok)}k=g({children:[{tag:"a#popupS-resetFocusBack."+a.baseClassName+"-resetFocus",href:"#",text:"Reset Focus"},a.flags.showCloseBtn&&a.closeBtn,j&&{tag:"h5."+a.baseClassName+"-title"+m,text:j},{tag:"."+a.baseClassName+"-content"+m,html:o,children:n&&k},{tag:"a#popupS-resetFocus."+a.baseClassName+"-resetFocus",href:"#",text:"Reset Focus"}]}),this._resetLayer(),h(this.$layerEl.childNodes[0],k),this._appendPopup(),this.$contentEl=this.$layerEl.getElementsByClassName(a.baseClassName+"-content")[0],this._resetEvent=this._resetEvent.bind(this),this._okEvent=this._okEvent.bind(this),this._cancelEvent=this._cancelEvent.bind(this),this._commonEvent=this._commonEvent.bind(this),this._keyEvent=this._keyEvent.bind(this),c=document.getElementById("popupS-resetFocus"),e=document.getElementById("popupS-resetFocusBack"),d(c,"focus",this._resetEvent),d(e,"focus",this._resetEvent),i(this.$layerEl),this.$btnOK=document.getElementById("popupS-button-ok")||void 0,"undefined"!=typeof this.$btnOK&&d(this.$btnOK,"click",this._okEvent),this.$btnCancel=document.getElementById("popupS-button-cancel")||void 0,"undefined"!=typeof this.$btnCancel&&d(this.$btnCancel,"click",this._cancelEvent),this.$input=document.getElementById("popupS-input")||void 0,a.flags.showCloseBtn&&d(document.getElementById("popupS-close"),"click",this._cancelEvent),a.flags.closeByOverlay&&d(this.$overlayEl,"click",this._cancelEvent),a.flags.closeByEsc&&d(document.body,"keyup",this._keyEvent),"function"==typeof this.callbacks.onOpen&&this.callbacks.onOpen.call(this)},_appendPopup:function(){this.$targetEl=a.appendLocation,h(this.$targetEl,this.$wrapEl),this.$targetEl===(document.body||document.documentElement)&&a.flags.bodyScroll===!1&&f(this.$targetEl,{overflow:"hidden"}),window.getComputedStyle&&window.getComputedStyle(this.$wrapEl,null).height;var b=function(a){return new RegExp("(|\\s+)"+a+"(\\s+|$)")};b(" "+a.baseClassName+"-open").test(this.$wrapEl.className)||(this.$wrapEl.className+=" "+a.baseClassName+"-open"),b(" "+a.baseClassName+"-open").test(this.$layerEl.childNodes[0].className)||(this.$layerEl.childNodes[0].className+=" "+a.baseClassName+"-open")},_loading:function(b){this.$loadingEl=g({tag:"div."+a.baseClassName+"-loading."+a.loader}),b?(this._resetLayer(),f(this.$layerEl.childNodes[0],{height:"60px",width:"60px",borderRadius:"30px"}),h(this.$layerEl.childNodes[0],this.$loadingEl),this._appendPopup()):f(this.$layerEl.childNodes[0],{height:null,width:null,borderRadius:null})},_hide:function(){var b,c,f,g=this;p.splice(0,1),p.length>0?this._create():(o=!1,b=function(){k(g.$wrapEl),g.$targetEl===(document.body||document.documentElement)&&a.flags.bodyScroll===!1&&(g.$targetEl.style.removeProperty?g.$targetEl.style.removeProperty("overflow"):g.$targetEl.style.removeAttribute("overflow"))},c=function(a){a.stopPropagation(),e(g.$wrapEl,m.type,c),b()},f=function(a){a.stopPropagation(),e(g.$layerEl,m.type,c)},this.$wrapEl.className=this.$wrapEl.className.replace(" "+a.baseClassName+"-open",""),m.supported?d(this.$wrapEl,m.type,c):b(),this.$layerEl.childNodes[0].className=this.$layerEl.childNodes[0].className.replace(" "+a.baseClassName+"-open",""),m.supported&&d(this.$layerEl,m.type,f))},_loadContents:function(a){var b=a.ajax.url,c="undefined"!=typeof a.ajax.str?a.ajax.str:"",d="undefined"!=typeof a.ajax.post?a.ajax.post:!0,e=this;if(b.match(q)){var f=g({children:{tag:"img",src:b}});this._loading(!0),this._preLoadImage(f,function(){e._loading(!1),a.content=f,e._createPopup(a)})}else this._ajax(b,c,d,function(b){var c=g({html:this});e._preLoadImage(c,function(){e._loading(!1),a.content=c,e._createPopup(a)})},function(){e._loading(!0)})},_preLoadImage:function(a,b){for(var c,f=j(a,"img"),g=f.length,h=g,i=function(){if(--h<=0){for(g=f.length;g--;)c=f[g],e(c,"load",i),e(c,"error",i);b()}};g--;)c=f[g],c.complete?h--:(d(c,"load",i),d(c,"error",i));!h&&i()},_ajax:function(a,b,c,d,e){var f;if(window.XMLHttpRequest)f=new XMLHttpRequest;else if(ActiveXObject("Microsoft.XMLHTTP"))f=new ActiveXObject("Microsoft.XMLHTTP");else{if(!ActiveXObject("Msxml2.XMLHTTP"))return alert("Error: Your browser does not support AJAX."),!1;f=new ActiveXObject("Msxml2.XMLHTTP")}return f.onreadystatechange=function(){4==f.readyState&&200==f.status&&d&&d.call(f.responseText)},c===!1?(f.open("GET",a+b,!0),f.send(null)):(f.open("POST",a,!0),f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.send(b)),e&&e.call(),f},_okEvent:function(a){"undefined"!=typeof a.preventDefault&&a.preventDefault(),"function"==typeof this.callbacks.onSubmit&&("undefined"!=typeof this.$input?this.callbacks.onSubmit.call(this,this.$input.value):this.callbacks.onSubmit.call(this)),this._commonEvent()},_cancelEvent:function(a){"undefined"!=typeof a.preventDefault&&a.preventDefault(),"function"==typeof this.callbacks.onClose&&this.callbacks.onClose.call(this),this._commonEvent()},_commonEvent:function(){a.flags.closeByEsc&&e(document.body,"keyup",this._keyEvent),a.flags.closeByOverlay&&e(this.$overlayEl,"click",this._cancelEvent),this._hide()},_resetEvent:function(a){i(this.$layerEl)},_keyEvent:function(a){var b=a.keyCode;"undefined"!=typeof this.$input&&13===b&&this._okEvent(a),27===b&&this._cancelEvent(a)},_appendButtons:function(b,c){return a.flags.buttonReverse?c+b:b+c}},{window:function(a){if(!(a instanceof Object))throw new Error("givven parameter must be an object");n._dialog(a)},close:function(){n._commonEvent()},alert:function(){},confirm:function(){},prompt:function(){},modal:function(){}}}});